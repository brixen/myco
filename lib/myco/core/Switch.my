
::Myco::Switch < ::Myco::Object {
  var input: void
  var output: void
  var matched: false
  
  when: |expected, &blk| {
    matched || (
      (input == expected)
      && (matched() = true) # TODO: make matched var shadow matched local?
        && (output() = blk.call(input))
    )
    self
  }
  
  else: |&blk| {
    matched || (
      (matched() = true)
      && (output() = blk.call(input))
    )
    self
  }
}
